# Sitemap HTML Downloader

A Python script to download all HTML pages listed in a sitemap, clean them by removing CSS, navigation, headers, footers, and scripts, and save the result as either cleaned HTML or plain text files.

## Features

- Downloads all URLs listed in a sitemap XML.
- Cleans downloaded HTML by removing non-content elements.
- Supports saving as cleaned HTML or plain text.
- Automatically skips pages not modified since the last run.
- Multi-threaded downloads for faster operation.
- Progress bar with real-time status updates.
- Automatic retry for failed downloads (default 3 retries).
- Command-line configurable.

## Requirements

- Python 3.7+
- Install dependencies:

```bash
pip install requests beautifulsoup4 tqdm
```

## Usage

```bash
python download_site.py <sitemap_url> [options]
```

### Positional Arguments

- `sitemap_url` - URL to the sitemap.xml file to download.

### Options

- `--output-dir DIR`     Output directory for saved files (default: `tmp`)
- `--text-only`          Save output as plain text instead of HTML.
- `--limit N`            Limit the number of pages to download (useful for testing).
- `--force`              Force download all pages, ignoring last modified timestamps.
- `--workers N`          Number of concurrent download threads (default: 5).
- `--retries N`          Number of retries per failed download (default: 3).

### Example

Download and clean all pages into `tmp/` as plain text, using 10 threads:

```bash
python download_site.py https://example.com/sitemap.xml --output-dir tmp --text-only --workers 10
```

Force redownload all pages, ignoring modification times:

```bash
python download_site.py https://example.com/sitemap.xml --force
```

Limit to downloading only the first 10 pages:

```bash
python download_site.py https://example.com/sitemap.xml --limit 10
```

## How it Works

1. Downloads the sitemap XML.
2. Parses all `<loc>` entries (optionally using `<lastmod>` timestamps).
3. Downloads each HTML page concurrently.
4. Cleans unwanted HTML elements.
5. Saves cleaned content to the output directory.
6. Tracks the last run timestamp to skip unmodified pages on future runs.

## License

MIT License

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Author

Generated by ChatGPT based on user specifications.

---

**Note**: This tool is designed for legitimate use cases such as personal archiving, site backups, or offline reading. Always respect a website's terms of service and robots.txt rules.

